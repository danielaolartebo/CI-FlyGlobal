<?xml version="1.0" encoding="UTF-8"?>
<entity-mappings
        xmlns="http://xmlns.jcp.org/xml/ns/persistence/orm"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/persistence/orm
        http://xmlns.jcp.org/xml/ns/persistence/orm_2_2.xsd"
        version="2.2">

    <entity class="com.xplorcolombia.xplorcolombia.domain.Destination">

        <named-native-query name="Destination.seeDestinations" result-set-mapping="seeDestinations">
            <query>
                SELECT id, name AS nameD
                FROM destination
                WHERE state = 'A'
            </query>
        </named-native-query>

        <named-native-query name="Destination.seeDestinationsPerPackage" result-set-mapping="seeDestinationsPerPackage">
            <query>
                select dest.name
                from destination dest
                join package_destination pd on dest.id = pd.destination_id
                join package p on p.id = pd.package_id
                where package_id = (select id from package where name = :pPackage)
                and dest.state = 'A'
            </query>
        </named-native-query>

        <named-native-query name="Destination.seeDestinationPerTripDestination" result-set-mapping="seeDestinationPerTripDestination">
            <query>
                select name
                from destination
                where id = (select destination_id
                from trip_destination where id = :pClientId)
            </query>
        </named-native-query>

    </entity>


    <entity class="com.xplorcolombia.xplorcolombia.domain.Transportation">
        <named-native-query name="Transportation.seeTransportationbyDestination" result-set-mapping="seeTransportationbyDestination">
            <query>
                select t.id as id, t.name as name, t.price as price
                from transportation t
                where t.destination_id = :pDest
                and t.state = 'A'
            </query>
        </named-native-query>

        <named-native-query name="Transportation.seeTransportationPerTripDestination" result-set-mapping="seeTransportationPerTripDestination">

            <query>
                select name
                from transportation
                where id = (select transportation_id
                from trip_destination where id = :pId)
            </query>
        </named-native-query>
    </entity>

    <entity class="com.xplorcolombia.xplorcolombia.domain.TripInsurance">
        <named-native-query name="TripInsurance.seeTripInsurancebyDestination" result-set-mapping="seeTripInsurancebyDestination">
            <query>
                select t.id as id, t.type as type, t.price as price
                from trip_insurance t
                where t.destination_id = :pDest
                and t.state = 'A'
            </query>
        </named-native-query>

        <named-native-query name="TripInsurance.seeTripInsurancePerTripDestination" result-set-mapping="seeTripInsurancePerTripDestination">

            <query>
                select type
                from trip_insurance
                where id = (select tripinsurance_id
                from trip_destination where id = :pId)
            </query>
        </named-native-query>
    </entity>

    <entity class="com.xplorcolombia.xplorcolombia.domain.Meals">
        <named-native-query name="Meals.seeMealbyDestination" result-set-mapping="seeMealbyDestination">
            <query>
                select m.id as id, m.type as type, m.price as price
                from meals m
                where m.destination_id = :pDest
                and m.state = 'A'
            </query>
        </named-native-query>

        <named-native-query name="Meals.seeMealsPerTripDestination" result-set-mapping="seeMealsPerTripDestination">
            <query>
                select type
                from meals
                where id = (select meals_id
                from trip_destination where id = :pId)

            </query>
        </named-native-query>
    </entity>

    <entity class="com.xplorcolombia.xplorcolombia.domain.Accommodation">
        <named-native-query name="Accommodation.seeAccommodationbyDestination" result-set-mapping="seeAccommodationbyDestination">
            <query>
                select a.id as id, a.name as name, a.price as price, a.lodging as lodging
                from accommodation a
                where a.destination_id = :pDest
                and a.state = 'A'
            </query>
        </named-native-query>

        <named-native-query name="Accommodation.seeAccommodationPerTripDestination" result-set-mapping="seeAccommodationPerTripDestination">
            <query>
                select name
                from accommodation
                where id = (select accommodation_id
                from trip_destination where id = :pId)
            </query>
        </named-native-query>
    </entity>

    <entity class="com.xplorcolombia.xplorcolombia.domain.Package">
        <named-native-query name="Package.seePackages" result-set-mapping="seePackages">
            <query>
                select name, id
                from package
                where state = 'A'
            </query>
        </named-native-query>
    </entity>

    <entity class="com.xplorcolombia.xplorcolombia.domain.Trip">
        <named-native-query name="Trip.seeTripPerClient" result-set-mapping="seeTripPerClient">
            <query>
                select id,num_people
                from trip
                where customer_id = :pId
                and state = 'A'
            </query>
        </named-native-query>
        <named-native-query name="Trip.seeTripPerPackage" result-set-mapping="seeTripPerPackage">
            <query>
                select id
                from trip
                where package_id = (select id
                from package where name = :pPack)
            </query>
        </named-native-query>
    </entity>

    <entity class="com.xplorcolombia.xplorcolombia.domain.Customer">
        <named-native-query name="Customer.seeCustomer" result-set-mapping="seeCustomer">
            <query>
                select id, email, name, nit
                from customer
                where id = :pId
            </query>
        </named-native-query>
    </entity>

    <entity class="com.xplorcolombia.xplorcolombia.domain.TripDestination">
        <named-native-query name="TripDestination.seeTripDestPerClient" result-set-mapping="seeCustomer">
            <query>
                select id
                from trip_destination
                where trip_id = :pId
            </query>
        </named-native-query>
    </entity>

</entity-mappings>